<!-- <!DOCTYPE html> -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEARCH MENU</title>
    <link rel="stylesheet" href="./styles/search.css" />
    <link rel="stylesheet" href="./styles/index.css" />
    <link rel="stylesheet" href="styles/foot.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Bree+Serif&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="searchmain">
      <div id="nav"></div>
      <div id="search">
        <input id="searchInput" type="text" placeholder="Search Dishes" />
        <div id="searchResults"></div>
        <div id="#displaySearch"></div>
      </div>
    </div>
  </body>
  <footer>
    <div id="getfooter"></div>
  </footer>
</html>
<script type="module">
  import navbar from "./components/navbar.js";

  let cont = document.getElementById("nav");
  cont.innerHTML = navbar();

  var input = document.getElementById("searchInput");
  input.addEventListener("input", debouncer);
  async function SearchList() {
    try {
      var menuValue = input.value;
      if (menuValue.length < 1) {
        console.log(1);
        window.location.href = "search.html";
        return false;
      }

      let response = await fetch(`http://localhost:2345/name/searching?search=${menuValue}`);

      let data = await response.json();
      console.log("data", data);
       console.log("data", data.meals);
      // displaySearchList(data.meals);
      displaySearch(data);
    } catch (error) {
      console.log("error", error);
    }
  }

  var search_waiting;
  function debouncer() {
    if (search_waiting) {
      clearTimeout(search_waiting);
    }

    search_waiting = setTimeout(function () {
      SearchList();
      //Schedule a setTimeout after delay seconds
    }, 1000);
  }
  ///////////////////////////////////////////////////
  var optiondiv = document.querySelector("#searchResults");

  let displaySearch = (data) => {
    if (data === undefined) {
      return false;
    }

    data.map((ele) => {
      console.log("data", data);

      var menu_div = document.createElement("div");

      var menuImg = document.createElement("img");
      menuImg.src = ele.image;

      var menuName = document.createElement("h2");
      menuName.textContent = ele.name;
      menu_div.append(menuImg, menuName);

      menu_div.addEventListener("click", letsSee);
      function letsSee() {
        localStorage.setItem("localDta", JSON.stringify(ele));
        window.location.href = "search.html";
      }
      optiondiv.append(menu_div);
    });
  };
  
//////
// exports.listSearch = (req, res) => {
//   // create query object to hold search value and category value
//   const query = {};
//   // assign search value to query.name
//   if (req.query.search) {
//     query.name = { $regex: req.query.search, $options: 'i' };
//     // assigne category value to query.category
//     if (req.query.category && req.query.category != 'All') {
//       query.category = req.query.category;
//     }
//     // find the product based on query object with 2 properties
//     // search and category
//     Product.find(query, (err, products) => {
//       if (err) {
//         return res.status(400).json({
//           error: errorHandler(err),
//         });
//       }
//       res.json(products);
//     }).select('-photo');
//   }
// };
/////
  let foot = document.querySelector("#getfooter");
  import footer from "./components/footer.js";
  foot.innerHTML = footer();
</script>

